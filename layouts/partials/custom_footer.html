<script>
// Copy code functionality - progressive enhancement
document.addEventListener('DOMContentLoaded', function() {
    // Only add copy functionality if browser supports clipboard API
    if (navigator.clipboard) {
        const codeBlocks = document.querySelectorAll('.highlight');

        codeBlocks.forEach(function(block) {
            // Create copy button
            const button = document.createElement('button');
            button.className = 'copy-code-button';
            button.textContent = 'Copy';
            button.setAttribute('aria-label', 'Copy code to clipboard');

            // Style the button
            button.style.cssText = `
                position: absolute;
                top: 8px;
                right: 8px;
                background: #ffffff;
                border: 1px solid #d1d5da;
                border-radius: 3px;
                padding: 4px 8px;
                font-size: 11px;
                color: #586069;
                cursor: pointer;
                z-index: 2;
                opacity: 0;
                transition: opacity 0.2s ease;
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            `;

            // Add click handler
            button.addEventListener('click', function() {
                const code = block.querySelector('code');
                if (code) {
                    const text = code.textContent || code.innerText;
                    navigator.clipboard.writeText(text).then(function() {
                        button.textContent = 'Copied!';
                        button.style.background = '#28a745';
                        button.style.color = '#ffffff';
                        button.style.borderColor = '#28a745';

                        setTimeout(function() {
                            button.textContent = 'Copy';
                            button.style.background = '#ffffff';
                            button.style.color = '#586069';
                            button.style.borderColor = '#d1d5da';
                        }, 2000);
                    }).catch(function() {
                        button.textContent = 'Failed';
                        setTimeout(function() {
                            button.textContent = 'Copy';
                        }, 2000);
                    });
                }
            });

            // Show button on hover
            block.addEventListener('mouseenter', function() {
                button.style.opacity = '1';
            });

            block.addEventListener('mouseleave', function() {
                button.style.opacity = '0';
            });

            // Add button to block
            block.style.position = 'relative';
            block.appendChild(button);
        });
    }
});
</script>